<!doctype html>
<html lang="en-GB-oxendict"><head><meta charset="utf-8">
<title>Well-Formed Unicode Strings</title><script src="ecmarkup.js?cache=dGIk58qK" defer=""></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.0.1/styles/base16/solarized-light.min.css"><link rel="stylesheet" href="ecmarkup.css"></head><body><div id="shortcuts-help">
<ul>
  <li><span>Toggle shortcuts help</span><code>?</code></li>
  <li><span>Toggle "can call user code" annotations</span><code>u</code></li>

  <li><span>Jump to search box</span><code>/</code></li>
</ul></div><div id="menu-toggle"><svg xmlns="http://www.w3.org/2000/svg" style="width:100%; height:100%; stroke:currentColor" viewBox="0 0 120 120">
      <title>Menu</title>
      <path stroke-width="10" stroke-linecap="round" d="M30,60 h60  M30,30 m0,5 h60  M30,90 m0,-5 h60"></path>
    </svg></div><div id="menu-spacer" class="menu-spacer"></div><div id="menu"><div id="menu-search"><input type="text" id="menu-search-box" placeholder="Search..."><div id="menu-search-results" class="inactive"></div></div><div id="menu-pins"><div class="menu-pane-header">Pins</div><ul id="menu-pins-list"></ul></div><div class="menu-pane-header">Table of Contents</div><div id="menu-toc"><ol class="toc"><li><span class="item-toggle">â—¢</span><a href="#sec-properties-of-the-string-prototype-object" title="Properties of the String Prototype Object"><span class="secnum">22.1.3</span> Properties of the String Prototype Object</a><ol class="toc"><li><span class="item-toggle-none"></span><a href="#sec-string.prototype.iswellformed" title="String.prototype.isWellFormed ( )"><span class="secnum">22.1.3.10</span> String.prototype.isWellFormed ( )</a></li><li><span class="item-toggle-none"></span><a href="#sec-string.prototype.towellformed" title="String.prototype.toWellFormed ( )"><span class="secnum">22.1.3.11</span> String.prototype.toWellFormed ( )</a></li></ol></li></ol></div></div><div id="spec-container"><h1 class="version">Stage 3 Draft / March 2, 2023</h1><h1 class="title">Well-Formed Unicode Strings</h1>

<emu-clause number="22.1.3" id="sec-properties-of-the-string-prototype-object">
  <h1><span class="secnum">22.1.3</span> Properties of the String Prototype Object</h1>

  <emu-clause number="10" id="sec-string.prototype.iswellformed">
    <h1><span class="secnum">22.1.3.10</span> String.prototype.isWellFormed ( )</h1>
    <p>This method performs the following steps when called:</p>
    <emu-alg><ol><li>Let <var>O</var> be ?&nbsp;<emu-xref aoid="RequireObjectCoercible"><a href="https://tc39.es/ecma262/#sec-requireobjectcoercible">RequireObjectCoercible</a></emu-xref>(<emu-val>this</emu-val> value).</li><li>Let <var>S</var> be ?&nbsp;<emu-xref aoid="ToString"><a href="https://tc39.es/ecma262/#sec-tostring">ToString</a></emu-xref>(<var>O</var>).</li><li>Return <emu-xref aoid="IsStringWellFormedUnicode"><a href="https://tc39.es/ecma262/#sec-isstringwellformedunicode">IsStringWellFormedUnicode</a></emu-xref>(<var>S</var>).</li></ol></emu-alg>
  </emu-clause>

  <emu-clause number="11" id="sec-string.prototype.towellformed">
    <h1><span class="secnum">22.1.3.11</span> String.prototype.toWellFormed ( )</h1>
    <p>This method returns a String representation of this object with all <emu-xref href="#leading-surrogate"><a href="https://tc39.es/ecma262/#leading-surrogate">leading surrogates</a></emu-xref> and <emu-xref href="#trailing-surrogate"><a href="https://tc39.es/ecma262/#trailing-surrogate">trailing surrogates</a></emu-xref> that are not part of a <emu-xref href="#surrogate-pair"><a href="https://tc39.es/ecma262/#surrogate-pair">surrogate pair</a></emu-xref> replaced with U+FFFD (REPLACEMENT CHARACTER).</p>
    <p>It performs the following steps when called:</p>
    <emu-alg><ol><li>Let <var>O</var> be ?&nbsp;<emu-xref aoid="RequireObjectCoercible"><a href="https://tc39.es/ecma262/#sec-requireobjectcoercible">RequireObjectCoercible</a></emu-xref>(<emu-val>this</emu-val> value).</li><li>Let <var>S</var> be ?&nbsp;<emu-xref aoid="ToString"><a href="https://tc39.es/ecma262/#sec-tostring">ToString</a></emu-xref>(<var>O</var>).</li><li>Let <var>strLen</var> be the length of <var>S</var>.</li><li>Let <var>k</var> be 0.</li><li>Let <var>result</var> be the empty String.</li><li>Repeat, while <var>k</var> &lt; <var>strLen</var>,<ol><li>Let <var>cp</var> be <emu-xref aoid="CodePointAt"><a href="https://tc39.es/ecma262/#sec-codepointat">CodePointAt</a></emu-xref>(<var>S</var>, <var>k</var>).</li><li>If <var>cp</var>.[[IsUnpairedSurrogate]] is <emu-val>true</emu-val>, then<ol><li>Set <var>result</var> to the <emu-xref href="#string-concatenation"><a href="https://tc39.es/ecma262/#string-concatenation">string-concatenation</a></emu-xref> of <var>result</var> and 0xFFFD (REPLACEMENT CHARACTER).</li></ol></li><li>Else,<ol><li>Set <var>result</var> to the <emu-xref href="#string-concatenation"><a href="https://tc39.es/ecma262/#string-concatenation">string-concatenation</a></emu-xref> of <var>result</var> and <emu-xref aoid="UTF16EncodeCodePoint"><a href="https://tc39.es/ecma262/#sec-utf16encodecodepoint">UTF16EncodeCodePoint</a></emu-xref>(<var>cp</var>.[[CodePoint]]).</li></ol></li><li>Set <var>k</var> to <var>k</var> + <var>cp</var>.[[CodeUnitCount]].</li></ol></li><li>Return <var>result</var>.</li></ol></emu-alg>
  </emu-clause>
</emu-clause>
</div></body></html>